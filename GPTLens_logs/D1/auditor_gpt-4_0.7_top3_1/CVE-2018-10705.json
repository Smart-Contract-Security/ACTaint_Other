[
    {
        "function_name": "setOwner",
        "code": "function setOwner(address _owner) returns (bool success) { owner = _owner; return true; }",
        "vulnerability": "Unprotected ownership",
        "reason": "The setOwner function can be called by anyone and not just the current owner. This means that an attacker can take over the contract and become the new owner.",
        "file_name": "CVE-2018-10705.sol"
    },
    {
        "function_name": "approve",
        "code": "function approve(address _spender, uint256 _value) public returns (bool success) { require(!locked); allowance[msg.sender][_spender] = _value; return true; }",
        "vulnerability": "Race Condition",
        "reason": "This function is vulnerable to a race condition due to front-running. An attacker can monitor the pending transactions pool and as soon as an approve transaction is found, the attacker can issue a higher gas price transaction to spend the allowance before the original spender.",
        "file_name": "CVE-2018-10705.sol"
    },
    {
        "function_name": "uploadBalances",
        "code": "function uploadBalances(address[] recipients, uint256[] balances) onlyOwner { require(!balancesUploaded); uint256 sum = 0; for (uint256 i = 0; i < recipients.length; i++) { balanceOf[recipients[i]] = safeAdd(balanceOf[recipients[i]], balances[i]); sum = safeAdd(sum, balances[i]); } balanceOf[owner] = safeSub(balanceOf[owner], sum); }",
        "vulnerability": "Arbitrary balance manipulation",
        "reason": "The function uploadBalances allows the owner to arbitrarily set the balances of any addresses. An attacker who becomes the owner can use this to drain all the tokens by setting the balance of all other addresses to 0 and theirs to the total supply.",
        "file_name": "CVE-2018-10705.sol"
    }
]