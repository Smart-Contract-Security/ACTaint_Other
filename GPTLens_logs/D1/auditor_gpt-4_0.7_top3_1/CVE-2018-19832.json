[
    {
        "function_name": "approve",
        "code": "function approve(address _spender, uint256 _value) public returns (bool success) { if (_value != 0 && allowed[msg.sender][_spender] != 0) { return false; } allowed[msg.sender][_spender] = _value; emit Approval(msg.sender, _spender, _value); return true; }",
        "vulnerability": "Race Condition / Front Running",
        "reason": "The 'approve' function of the ERC20 token standard is known to be vulnerable to a race condition. If a user wants to change the allowance of a spender that is not zero, they have to set the allowance to zero first in a separate transaction. If they don't, the spender can front run the transaction that sets the new allowance, spending the original allowance and the new allowance.",
        "file_name": "CVE-2018-19832.sol"
    },
    {
        "function_name": "withdraw",
        "code": "function withdraw() onlyOwner public { uint256 etherBalance = address(this).balance; owner.transfer(etherBalance); }",
        "vulnerability": "Arbitrary Withdrawal by Owner",
        "reason": "The 'withdraw' function allows the contract owner to withdraw all the contract's balance at any time. This could result in loss of funds for users if the owner decides to act maliciously.",
        "file_name": "CVE-2018-19832.sol"
    },
    {
        "function_name": "distr",
        "code": "function distr(address _to, uint256 _amount) canDistr private returns (bool) { totalDistributed = totalDistributed.add(_amount); totalRemaining = totalRemaining.sub(_amount); balances[_to] = balances[_to].add(_amount); emit Distr(_to, _amount); emit Transfer(address(0), _to, _amount); return true; if (totalDistributed >= totalSupply) { distributionFinished = true; } }",
        "vulnerability": "Unreachable Code",
        "reason": "The 'return true' statement is followed by more code. This makes the code after the return statement unreachable and hence useless. In this case, the check for 'totalDistributed >= totalSupply' will never be reached, and 'distributionFinished' will never be set to true.",
        "file_name": "CVE-2018-19832.sol"
    }
]