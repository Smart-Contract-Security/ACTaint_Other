[
    {
        "function_name": "distr",
        "code": "function distr(address _to, uint256 _amount) canDistr private returns (bool) { totalDistributed = totalDistributed.add(_amount); totalRemaining = totalRemaining.sub(_amount); balances[_to] = balances[_to].add(_amount); emit Distr(_to, _amount); emit Transfer(address(0), _to, _amount); return true; if (totalDistributed >= totalSupply) { distributionFinished = true; } }",
        "vulnerability": "Unreachable code",
        "reason": "After the 'return' statement, the code will not be executed, so 'if (totalDistributed >= totalSupply) { distributionFinished = true; }' will never be executed. This could lead to an indefinite distribution of tokens even totalDistributed is greater than totalSupply.",
        "file_name": "CVE-2019-15078.sol"
    },
    {
        "function_name": "approve",
        "code": "function approve(address _spender, uint256 _value) public returns (bool success) { if (_value != 0 && allowed[msg.sender][_spender] != 0) { return false; } allowed[msg.sender][_spender] = _value; emit Approval(msg.sender, _spender, _value); return true; }",
        "vulnerability": "Approval Race Condition (ERC20)",
        "reason": "This function allows for potential double-spending due to the race condition in ERC20 standard. An attacker could be approved to spend tokens, spend them, then have the approval amount increased and spend the new approval, essentially spending more than originally approved.",
        "file_name": "CVE-2019-15078.sol"
    },
    {
        "function_name": "getTokens",
        "code": "function getTokens() payable canDistr onlyWhitelist public { if (value > totalRemaining) { value = totalRemaining; } require(value <= totalRemaining); address investor = msg.sender; uint256 toGive = value; distr(investor, toGive); if (toGive > 0) { blacklist[investor] = true; } if (totalDistributed >= totalSupply) { distributionFinished = true; } value = value.div(100000).mul(99999); }",
        "vulnerability": "Re-entrancy",
        "reason": "The function allows for potential re-entrancy attacks. While it doesn't directly call external contracts, it does call the 'distr' function which emits an event. If the event listener were malicious, it could attempt re-entrancy. Also, the value is changed after calling distr which can lead to inconsistencies.",
        "file_name": "CVE-2019-15078.sol"
    }
]