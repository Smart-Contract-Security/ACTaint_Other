[
    {
        "function_name": "owned",
        "code": "function owned() public { owner = msg.sender; }",
        "vulnerability": "Incorrect function constructor",
        "reason": "The function 'owned()' is supposed to be a constructor for the contract 'Owned' but it is not. The correct name for the constructor in solidity 0.4.18 should be 'function Owned()'. This means that the 'owner' of the contract is not being set upon contract creation. Anybody can call 'owned()' function and take ownership of the contract.",
        "file_name": "CVE-2021-34272.sol"
    },
    {
        "function_name": "transferOwnership",
        "code": "function transferOwnership(address newOwner) onlyOwner public { owner = newOwner; }",
        "vulnerability": "No validation of new owner address",
        "reason": "The function 'transferOwnership' does not validate if the 'newOwner' address is non-zero. This could enable the current owner to set the 'newOwner' as the '0x0' address, which would make the contract ownerless and no one would be able to call the functions with the 'onlyOwner' modifier.",
        "file_name": "CVE-2021-34272.sol"
    },
    {
        "function_name": "buy",
        "code": "function buy() payable public { require(isOpened); uint amount = msg.value / buyPrice; _transfer(this, msg.sender, amount); }",
        "vulnerability": "Integer division",
        "reason": "In the 'buy' function, 'msg.value / buyPrice' is using integer division, which can lead to loss of funds due to rounding errors. Solidity doesn't handle fractional numbers so all divisions are rounded down to the nearest whole number. This might not be an issue if 'buyPrice' is always less than 'msg.value' but it could lead to potentially significant rounding errors otherwise.",
        "file_name": "CVE-2021-34272.sol"
    }
]