[
    {
        "function_name": "owned",
        "vulnerability": "Incorrect function constructor",
        "criticism": "The reasoning is correct. The function 'owned()' is supposed to be a constructor but it is not. This means that the 'owner' of the contract is not being set upon contract creation. Anybody can call 'owned()' function and take ownership of the contract. The severity is high because it allows anyone to take control of the contract. The profitability is also high because an attacker can take control of the contract and manipulate it for their own benefit.",
        "correctness": 9,
        "severity": 9,
        "profitability": 9,
        "reason": "The function 'owned()' is supposed to be a constructor for the contract 'Owned' but it is not. The correct name for the constructor in solidity 0.4.18 should be 'function Owned()'. This means that the 'owner' of the contract is not being set upon contract creation. Anybody can call 'owned()' function and take ownership of the contract.",
        "code": "function owned() public { owner = msg.sender; }",
        "file_name": "CVE-2021-34272.sol",
        "final_score": 9.0
    },
    {
        "function_name": "transferOwnership",
        "vulnerability": "No validation of new owner address",
        "criticism": "The reasoning is correct. The function 'transferOwnership' does not validate if the 'newOwner' address is non-zero. This could enable the current owner to set the 'newOwner' as the '0x0' address, which would make the contract ownerless and no one would be able to call the functions with the 'onlyOwner' modifier. The severity is high because it can make the contract ownerless. The profitability is low because an external attacker cannot profit from this vulnerability.",
        "correctness": 9,
        "severity": 9,
        "profitability": 0,
        "reason": "The function 'transferOwnership' does not validate if the 'newOwner' address is non-zero. This could enable the current owner to set the 'newOwner' as the '0x0' address, which would make the contract ownerless and no one would be able to call the functions with the 'onlyOwner' modifier.",
        "code": "function transferOwnership(address newOwner) onlyOwner public { owner = newOwner; }",
        "file_name": "CVE-2021-34272.sol",
        "final_score": 6.75
    },
    {
        "function_name": "buy",
        "vulnerability": "Integer division",
        "criticism": "The reasoning is correct. In the 'buy' function, 'msg.value / buyPrice' is using integer division, which can lead to loss of funds due to rounding errors. Solidity doesn't handle fractional numbers so all divisions are rounded down to the nearest whole number. This might not be an issue if 'buyPrice' is always less than 'msg.value' but it could lead to potentially significant rounding errors otherwise. The severity is moderate because it can lead to loss of funds. The profitability is low because an external attacker cannot profit from this vulnerability.",
        "correctness": 9,
        "severity": 5,
        "profitability": 0,
        "reason": "In the 'buy' function, 'msg.value / buyPrice' is using integer division, which can lead to loss of funds due to rounding errors. Solidity doesn't handle fractional numbers so all divisions are rounded down to the nearest whole number. This might not be an issue if 'buyPrice' is always less than 'msg.value' but it could lead to potentially significant rounding errors otherwise.",
        "code": "function buy() payable public { require(isOpened); uint amount = msg.value / buyPrice; _transfer(this, msg.sender, amount); }",
        "file_name": "CVE-2021-34272.sol",
        "final_score": 5.75
    }
]