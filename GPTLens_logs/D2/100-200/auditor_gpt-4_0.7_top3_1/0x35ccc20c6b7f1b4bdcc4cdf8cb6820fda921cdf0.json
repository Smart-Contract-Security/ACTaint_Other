[
    {
        "function_name": "halt",
        "code": "function halt() external onlyOwner { halted = true; emit Halt(true, msg.sender, timestamp()); }",
        "vulnerability": "Reentrancy attack",
        "reason": "The 'halt' function in the 'Haltable' contract changes the state of the contract by setting 'halted' to true, and then emits an event which can include external calls. If the event listener or the logging mechanism is maliciously crafted, it could potentially re-enter the contract and modify its state or call other functions relying on the halted state. This could lead to unexpected behaviors or denial of service.",
        "file_name": "0x35ccc20c6b7f1b4bdcc4cdf8cb6820fda921cdf0.sol"
    },
    {
        "function_name": "newOracle",
        "code": "function newOracle(address _oracle) internal onlyOwner returns (uint256 id) { id = ++lastId; oracleData[_oracle].oracleId = id; oracleData[_oracle].oracleAuth = false; oracleData[_oracle].oracleAddress = _oracle; oracleAddressById[id] = _oracle; emit NewOracle(_oracle, id, timestamp()); }",
        "vulnerability": "Improper authorization",
        "reason": "The function 'newOracle' is marked as 'internal' and can only be called from within the contract or derived contracts. However, it does not properly check if the '_oracle' address being added is already an authorized oracle or if it already has an ID. This could lead to potential overwriting of existing oracles if called improperly by the contract owner or through another function that does not validate the input sufficiently.",
        "file_name": "0x35ccc20c6b7f1b4bdcc4cdf8cb6820fda921cdf0.sol"
    },
    {
        "function_name": "sendVote",
        "code": "function sendVote(string _vote) votingActive public returns (bool) { if (!canIVote()) { error('sendVote: sender cannot vote because it has previously casted another vote'); return false; } if (bytes(_vote).length < 1) { error('sendVote: vote is empty'); return false; } votes[msg.sender] = _vote; numVotes ++; emit SendVote(msg.sender, _vote); return true; }",
        "vulnerability": "Denial of Service",
        "reason": "The function 'sendVote' does not limit the size of the '_vote' string input. An attacker could potentially send an extremely large string to exhaust gas and cause the transaction to fail. This could be used to deny service to legitimate users trying to cast their votes, especially if combined with other gas-intensive operations.",
        "file_name": "0x35ccc20c6b7f1b4bdcc4cdf8cb6820fda921cdf0.sol"
    }
]