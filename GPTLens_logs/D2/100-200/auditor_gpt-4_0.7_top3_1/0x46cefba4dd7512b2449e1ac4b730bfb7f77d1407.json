[
    {
        "function_name": "withdrawAmount",
        "code": "function withdrawAmount (uint256 _amount) onlyAdmins() public { msg.sender.transfer(_amount); }",
        "vulnerability": "Unbounded Withdrawal",
        "reason": "This function allows an admin to withdraw any amount of Ether from the contract without any checks on the balance of the contract. This can lead to draining all the funds stored in the contract if an admin's account is compromised or an admin turns malicious.",
        "file_name": "0x46cefba4dd7512b2449e1ac4b730bfb7f77d1407.sol"
    },
    {
        "function_name": "buy",
        "code": "function buy(uint256 _id) public payable{ require(msg.value >= orderBook[_id].price); require(msg.sender != orderBook[_id].owner); require(!isContract(msg.sender)); require(orderBook[_id].startTime <= now && now <= orderBook[_id].endTime); orderBook[_id].owner.transfer(orderBook[_id].price*24/25); orderBook[_id].creator.transfer(orderBook[_id].price/50); if (msg.value > orderBook[_id].price) { msg.sender.transfer(msg.value - orderBook[_id].price); } orderBook[_id].owner = msg.sender; orderBook[_id].price = getNextPrice(orderBook[_id].price); }",
        "vulnerability": "Reentrancy",
        "reason": "This function transfers Ether to both the previous owner of the token and its creator before updating the ownership details in the orderBook. If the transfer to the previous owner is to a malicious contract, it can call back into this contract and manipulate or disrupt the state before the ownership transfer is recorded, potentially leading to issues like double-spending.",
        "file_name": "0x46cefba4dd7512b2449e1ac4b730bfb7f77d1407.sol"
    },
    {
        "function_name": "put",
        "code": "function put(address _issuer, uint256 _tokenId, uint256 _price, uint256 _startTime, uint256 _endTime) public { require(_startTime <= _endTime); Issuer issuer = Issuer(_issuer); require(issuer.ownerOf(_tokenId) == msg.sender); issuer.transferFrom(msg.sender, address(this), _tokenId); if (orderBookSize == orderBook.length) { orderBook.push(Order(msg.sender, msg.sender, _issuer, _tokenId, _price, _startTime, _endTime)); } else { orderBook[orderBookSize] = Order(msg.sender, msg.sender, _issuer, _tokenId, _price, _startTime, _endTime); } orderBookSize += 1; }",
        "vulnerability": "Unchecked External Call",
        "reason": "The function `put` transfers a token using `issuer.transferFrom` without checking the return value of this external call. If the call fails for any reason, the function will still proceed with updating the order book, which can lead to inconsistencies in token ownership tracking.",
        "file_name": "0x46cefba4dd7512b2449e1ac4b730bfb7f77d1407.sol"
    }
]