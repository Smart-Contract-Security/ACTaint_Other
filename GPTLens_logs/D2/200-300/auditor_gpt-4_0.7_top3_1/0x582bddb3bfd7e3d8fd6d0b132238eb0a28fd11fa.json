[
    {
        "function_name": "revoke",
        "code": "function revoke(address to, uint256 index) public onlyOwner { vault storage v = vaults[to][index]; require(now >= v.unlockTime); require(!v.claimed); v.claimed = true; require(EST.transfer(msg.sender, v.amount)); emit Revoke(to, index); }",
        "vulnerability": "Time manipulation and access control",
        "reason": "The 'revoke' function allows the contract owner to withdraw tokens from a vault even before the unlockTime has been reached, due to the incorrect condition check order. The function first checks if the current time is greater than or equal to unlockTime, which is correct, but the owner can bypass this by manipulating the system time or deploying a similar contract in his control. This could let the owner access and withdraw tokens prematurely.",
        "file_name": "0x582bddb3bfd7e3d8fd6d0b132238eb0a28fd11fa.sol"
    },
    {
        "function_name": "transferFrom",
        "code": "function transferFrom(address _from, address _to, uint256 _value) public returns(bool) { allowed[_from][msg.sender] = allowed[_from][msg.sender].sub(_value); _transfer(_from, _to, _value); return true; }",
        "vulnerability": "Reentrancy",
        "reason": "The 'transferFrom' function is vulnerable to reentrancy attacks. It modifies the allowed mapping (state change) after calling the internal '_transfer' function which emits an event. This ordering allows a malicious contract to call 'transferFrom' again when it receives tokens (via the emitted event) in the middle of execution, potentially leading to unexpected behavior or draining of tokens.",
        "file_name": "0x582bddb3bfd7e3d8fd6d0b132238eb0a28fd11fa.sol"
    },
    {
        "function_name": "approveAndCall",
        "code": "function approveAndCall(address _spender, uint256 _value, bytes _extraData) public returns(bool) { tokenRecipient spender = tokenRecipient(_spender); if (approve(_spender, _value)) { spender.receiveApproval(msg.sender, _value, this, _extraData); return true; } return false; }",
        "vulnerability": "Reentrancy",
        "reason": "In the 'approveAndCall' function, after approving tokens, it calls an external contract ('spender.receiveApproval'). This external call can potentially be exploited by a malicious contract to re-enter the ERC20 contract and call functions such as 'transfer' or 'transferFrom' before the original call finishes executing. This can lead to unexpected behavior or loss of funds.",
        "file_name": "0x582bddb3bfd7e3d8fd6d0b132238eb0a28fd11fa.sol"
    }
]