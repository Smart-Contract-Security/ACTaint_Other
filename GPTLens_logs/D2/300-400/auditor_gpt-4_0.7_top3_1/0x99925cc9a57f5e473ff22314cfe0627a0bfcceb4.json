[
    {
        "function_name": "deposit",
        "code": "function deposit() payable { if (msg.value < minimum_payment) throw; if (balances[msg.sender] == 0) deposit_fee = 0 ether; if ( msg.sender == thebank ){ balances[thebank] += msg.value; } else { any_customer_payments_yet = true; balances[msg.sender] += msg.value - deposit_fee; balances[thebank] += deposit_fee; term_deposit_end_block[msg.sender] = block.number + 30850; } }",
        "vulnerability": "Reentrancy",
        "reason": "The deposit function modifies the global state (balances and deposit_fee) after transferring Ether (in the form of deposit fees to the bank). This can allow for a reentrancy attack where an attacker repeatedly calls deposit before the first transaction is finished, potentially allowing for multiple deductions of the deposit fee from the bank's balance if the attacker's initial balance is zero.",
        "file_name": "0x99925cc9a57f5e473ff22314cfe0627a0bfcceb4.sol"
    },
    {
        "function_name": "withdraw",
        "code": "function withdraw(uint256 withdraw_amount) { if (withdraw_amount < 10 ether) throw; if ( withdraw_amount > balances[msg.sender] ) throw; if (block.number < term_deposit_end_block[msg.sender] ) throw; uint256 interest = 1 ether; if (msg.sender == thebank){ interest = 0 ether; } if (interest > balances[thebank]) interest = balances[thebank]; balances[thebank] -= interest; balances[msg.sender] -= withdraw_amount; if (!msg.sender.send(withdraw_amount)) throw; if (!msg.sender.send(interest)) throw; }",
        "vulnerability": "Reentrancy",
        "reason": "The withdraw function sends Ether to the caller twice using msg.sender.send without updating the sender's balance before the first send operation is executed. This can be exploited in a reentrancy attack, where the attacker recursively calls withdraw within a fallback function to drain the contract's funds.",
        "file_name": "0x99925cc9a57f5e473ff22314cfe0627a0bfcceb4.sol"
    },
    {
        "function_name": "set_deposit_fee",
        "code": "function set_deposit_fee (uint256 new_fee) { if ( msg.sender == thebank ){ deposit_fee = new_fee; } }",
        "vulnerability": "Arbitrary Fee Setting",
        "reason": "The set_deposit_fee function allows the owner (thebank) to arbitrarily set the deposit fee. There's no check on the upper limit of new_fee, which could be exploited by the owner to set extremely high fees, thus making it costly or impossible for users to deposit funds.",
        "file_name": "0x99925cc9a57f5e473ff22314cfe0627a0bfcceb4.sol"
    }
]