[
    {
        "function_name": "transferOwnership",
        "code": "function transferOwnership(address newOwner) public onlyOwner {\n    require( newOwner != 0x0 );\n    require( ownershipTransferAllowed );\n    owner = newOwner;\n    ownershipTransferAllowed = false;\n}",
        "vulnerability": "Risky ownership transfer",
        "reason": "The ownership transfer is only protected by the 'ownershipTransferAllowed' boolean flag. This flag can be set by the current owner, allowing or disallowing ownership transfer at will. An attacker who gains control over the owner's account could enable this flag and then transfer ownership to another address, which could lead to loss of control over the smart contract.",
        "file_name": "0xa86914a1402f3cdcb27084e08a47445e8ab1bbab.sol"
    },
    {
        "function_name": "sell",
        "code": "function sell(uint256 amountToken) public returns (uint256 revenue){\n    revenue = amountToken * tokenFactor / sellPrice;\n    require( revenue >= minimumPayout );\n    uint256 newPrice = _newPrice(balanceOf[this] + amountToken);\n    require( newPrice < sellPrice );\n    _transfer(msg.sender, this, amountToken);\n    _setPrices( newPrice );\n    msg.sender.transfer(revenue);\n    return revenue;\n}",
        "vulnerability": "Reentrancy",
        "reason": "The 'sell' function allows users to transfer tokens back to the contract in exchange for ether. It updates the contract state to reflect the new token balance and price after sending ether to the user. However, it does not follow the checks-effects-interactions pattern, and the transfer of ether (msg.sender.transfer(revenue)) happens before all state changes are finalized. This opens up the possibility of a reentrancy attack where a malicious contract could call back into 'sell' or other functions to manipulate state or drain funds in an unintended way.",
        "file_name": "0xa86914a1402f3cdcb27084e08a47445e8ab1bbab.sol"
    },
    {
        "function_name": "save",
        "code": "function save(uint256 amount) public onlyOwner {\n    require( amount >= minimumPayout );\n    owner.transfer( amount);\n}",
        "vulnerability": "Unchecked transfer",
        "reason": "The 'save' function allows the owner to transfer ether from the contract to the owner's address. It does not check the contract's balance before performing the transfer, which could result in an underflow if the contract balance is less than the amount being transferred. This could allow the owner to unintentionally drain all ether from the contract.",
        "file_name": "0xa86914a1402f3cdcb27084e08a47445e8ab1bbab.sol"
    }
]