[
    {
        "function_name": "approve",
        "code": "function approve(address _spender, uint _value) { if ((_value != 0) && (allowed[msg.sender][_spender] != 0)) throw; allowed[msg.sender][_spender] = _value; Approval(msg.sender, _spender, _value); }",
        "vulnerability": "Race condition",
        "reason": "The ERC20 'approve' function does not properly protect against the race condition known as the 'multiple withdrawal attack'. This vulnerability occurs because the function does not set the allowance to zero before setting it to a new value when it is not already zero. Attackers could potentially call 'transferFrom' multiple times before the 'approve' transaction is confirmed, allowing them to transfer more tokens than intended.",
        "file_name": "0xaf71b19e6292c6e1491ff3a54b3e63dbd41ef023.sol"
    },
    {
        "function_name": "transferFrom",
        "code": "function transferFrom(address _from, address _to, uint _value) onlyPayloadSize(3 * 32) { var _allowance = allowed[_from][msg.sender]; balances[_to] = balances[_to].add(_value); balances[_from] = balances[_from].sub(_value); allowed[_from][msg.sender] = _allowance.sub(_value); Transfer(_from, _to, _value); }",
        "vulnerability": "Unchecked return values",
        "reason": "This function uses the SafeMath library to perform safe arithmetic operations. However, it does not check the return values of these operations to ensure they succeed. If an arithmetic operation fails (e.g., subtraction resulting in a negative number), the function will continue execution with potentially corrupted state. This might lead to unexpected behavior such as transferring more tokens than allowed or corrupting the balances.",
        "file_name": "0xaf71b19e6292c6e1491ff3a54b3e63dbd41ef023.sol"
    },
    {
        "function_name": "transfer",
        "code": "function transfer(address _to, uint _value) onlyPayloadSize(2 * 32) { balances[msg.sender] = balances[msg.sender].sub(_value); balances[_to] = balances[_to].add(_value); Transfer(msg.sender, _to, _value); }",
        "vulnerability": "Unchecked return values",
        "reason": "Similar to 'transferFrom', this function also fails to check the return values from SafeMath operations. If an operation like subtraction fails due to underflow (when trying to transfer more tokens than the sender has), the function will continue with corrupted state, potentially allowing token theft or other unintended transfers.",
        "file_name": "0xaf71b19e6292c6e1491ff3a54b3e63dbd41ef023.sol"
    }
]