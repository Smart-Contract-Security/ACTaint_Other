[
    {
        "function_name": "getTokens",
        "code": "function getTokens() payable canDistr onlyWhitelist public {\n    if (value > totalRemaining) {\n        value = totalRemaining;\n    }\n    require(value <= totalRemaining);\n    address investor = msg.sender;\n    uint256 toGive = value;\n    distr(investor, toGive);\n    if (toGive > 0) {\n        blacklist[investor] = true;\n    }\n    if (totalDistributed >= totalSupply) {\n        distributionFinished = true;\n    }\n    value = value.div(100000).mul(99999);\n}",
        "vulnerability": "Reentrancy",
        "reason": "The function 'getTokens' updates the state after calling another function ('distr') that transfers control, potentially allowing reentrancy attack. The state variable 'value' is decreased after the distribution, which could be exploited if the same function is called again before it finishes execution.",
        "file_name": "0xb29b1547e2ce27161fda590f217c2c669e8a376a.sol"
    },
    {
        "function_name": "withdraw",
        "code": "function withdraw() onlyOwner public {\n    uint256 etherBalance = address(this).balance;\n    owner.transfer(etherBalance);\n}",
        "vulnerability": "Unprotected Ether Withdrawal",
        "reason": "The 'withdraw' function allows the owner to transfer all Ether in the contract to their own address. No checks or effects limit the frequency or conditions under which this withdrawal can occur, potentially allowing abrupt draining of all contract funds if the owner's account is compromised.",
        "file_name": "0xb29b1547e2ce27161fda590f217c2c669e8a376a.sol"
    },
    {
        "function_name": "approve",
        "code": "function approve(address _spender, uint256 _value) public returns (bool success) {\n    if (_value != 0 && allowed[msg.sender][_spender] != 0) {\n        return false;\n    }\n    allowed[msg.sender][_spender] = _value;\n    emit Approval(msg.sender, _spender, _value);\n    return true;\n}",
        "vulnerability": "Improper Approval Reset",
        "reason": "The 'approve' function does not reset the allowance to 0 before setting it to a new value, which can lead to a race condition known as the 'approve/transferFrom attack'. This allows a malicious spender to possibly transfer more tokens than intended by the token owner.",
        "file_name": "0xb29b1547e2ce27161fda590f217c2c669e8a376a.sol"
    }
]