[
    {
        "function_name": "transferFrom",
        "code": "function transferFrom(address from, address to, uint tokens) public returns (bool success) { balances[from] = safeSub(balances[from], tokens); allowed[from][msg.sender] = safeSub(allowed[from][msg.sender], tokens); balances[to] = safeAdd(balances[to], tokens); Transfer(from, to, tokens); return true; }",
        "vulnerability": "Missing authorization check",
        "reason": "The function 'transferFrom' does not check if 'msg.sender' is authorized by 'from' to spend tokens. The check of decrementing allowance happens after tokens are already subtracted from 'from' and added to 'to'. An attacker can exploit this by calling 'transferFrom' to transfer tokens without proper authorization from the token owner.",
        "file_name": "0xbb2f0ac18eb89502dfeb7ac3c4aabef76e75eca7.sol"
    },
    {
        "function_name": "approve",
        "code": "function approve(address spender, uint tokens) public returns (bool success) { allowed[msg.sender][spender] = tokens; Approval(msg.sender, spender, tokens); return true; }",
        "vulnerability": "Race condition",
        "reason": "The 'approve' function is susceptible to a race condition known as the 'approve/transferFrom attack'. If a user decides to change an already set allowance, they must first reduce it to zero and then set the new value. However, between these two operations, a malicious spender can call 'transferFrom' after the allowance is set to zero and before it is set to the new value, effectively exploiting the race condition.",
        "file_name": "0xbb2f0ac18eb89502dfeb7ac3c4aabef76e75eca7.sol"
    },
    {
        "function_name": "CBD",
        "code": "function CBD() public { symbol = 'CBD'; name = 'Cannabis Dollar'; decimals = 8; _totalSupply = 10000000000000000; balances[0x15711555d91797bF75f26Fe84367aDD7E92C1a0f] = _totalSupply; Transfer(address(0), 0x15711555d91797bF75f26Fe84367aDD7E92C1a0f, _totalSupply); }",
        "vulnerability": "Centralization of token supply",
        "reason": "In the constructor function 'CBD', all the initial supply is assigned to a single address. This poses a risk of centralization, where the owner of that address has complete control over all of the tokens. This could lead to manipulation of the token value and is against the principle of decentralized systems.",
        "file_name": "0xbb2f0ac18eb89502dfeb7ac3c4aabef76e75eca7.sol"
    }
]