[
    {
        "function_name": "migrate",
        "code": "function migrate() external onlyOwnerOrNewVersion { newVersionAddress.transfer(address(this).balance); }",
        "vulnerability": "Unauthorized Fund Transfer",
        "reason": "This function allows transferring all contract funds to 'newVersionAddress' without any checks on the state of the contract or restrictions on the transfer amount. If 'newVersionAddress' is maliciously set or hijacked, it could lead to a total loss of funds.",
        "file_name": "0xcdf9b522d962c0c45c9744ffa5ea6cedd07f6a6f.sol"
    },
    {
        "function_name": "paySuperPrize",
        "code": "function paySuperPrize(address payable winner) external onlyLoto { uint256 superPrizeAmount = dailyAmount + weeklyAmount + monthlyAmount + seasonalAmount; emit SuperPrize(superPrizeAmount, winner); winner.transfer(superPrizeAmount); }",
        "vulnerability": "Unrestricted Prize Payment",
        "reason": "The function 'paySuperPrize' transfers the sum of dailyAmount, weeklyAmount, monthlyAmount, and seasonalAmount to a 'winner' address without any validation of the winner or amount being appropriate. This could be exploited if the 'lotoAddress' is compromised, allowing arbitrary addresses to drain the prize amounts.",
        "file_name": "0xcdf9b522d962c0c45c9744ffa5ea6cedd07f6a6f.sol"
    },
    {
        "function_name": "settleJackpot",
        "code": "function settleJackpot() external { if (block.number >= dailyEnd) setDaily(); if (block.number >= weeklyEnd) setWeekly(); if (block.number >= monthlyEnd) setMonthly(); if (block.number >= seasonalEnd) setSeasonal(); if (block.number == dailyStart || (dailyStart < block.number - 256)) return; uint48 modulo = uint48(bytes6(blockhash(dailyStart) << 29)); uint256 dailyPayAmount; uint256 weeklyPayAmount; uint256 monthlyPayAmount; uint256 seasonalPayAmount; uint256 dailyWin; uint256 weeklyWin; uint256 monthlyWin; uint256 seasonalWin; if (dailyProcessed == false) { dailyPayAmount = dailyAmount * PRECISION / DAILY_PART / PRECISION; dailyAmount -= dailyPayAmount; dailyProcessed = true; dailyWin = getNumber(dailyNumberStartPrev, dailyNumberEndPrev, modulo); emit Jackpot(dailyWin, dailyNumberEndPrev - dailyNumberStartPrev + 1, dailyPayAmount, 0x01); } if (weeklyProcessed == false) { weeklyPayAmount = weeklyAmount * PRECISION / WEEKLY_PART / PRECISION; weeklyAmount -= weeklyPayAmount; weeklyProcessed = true; weeklyWin = getNumber(weeklyNumberStartPrev, weeklyNumberEndPrev, modulo); emit Jackpot(weeklyWin, weeklyNumberEndPrev - weeklyNumberStartPrev + 1, weeklyPayAmount, 0x02); } if (monthlyProcessed == false) { monthlyPayAmount = monthlyAmount * PRECISION / MONTHLY_PART / PRECISION; monthlyAmount -= monthlyPayAmount; monthlyProcessed = true; monthlyWin = getNumber(monthlyNumberStartPrev, monthlyNumberEndPrev, modulo); emit Jackpot(monthlyWin, monthlyNumberEndPrev - monthlyNumberStartPrev + 1, monthlyPayAmount, 0x04); } if (seasonalProcessed == false) { seasonalPayAmount = seasonalAmount; seasonalAmount -= seasonalPayAmount; seasonalProcessed = true; seasonalWin = getNumber(seasonalNumberStartPrev, seasonalNumberEndPrev, modulo); emit Jackpot(seasonalWin, seasonalNumberEndPrev - seasonalNumberStartPrev + 1, seasonalPayAmount, 0x08); } if (dailyPayAmount > 0) getAddress(dailyWin).transfer(dailyPayAmount); if (weeklyPayAmount > 0) getAddress(weeklyWin).transfer(weeklyPayAmount); if (monthlyPayAmount > 0) getAddress(monthlyWin).transfer(monthlyPayAmount); if (seasonalPayAmount > 0) getAddress(seasonalWin).transfer(seasonalPayAmount); }",
        "vulnerability": "Block Timestamp Dependency",
        "reason": "The function 'settleJackpot' uses block numbers to determine the ending of game periods and relies on 'blockhash' for randomness, which is only valid for the most recent 256 blocks. If not settled in time, the randomness can be manipulated by miners or become unavailable, leading to potential gaming of the prize distribution.",
        "file_name": "0xcdf9b522d962c0c45c9744ffa5ea6cedd07f6a6f.sol"
    }
]