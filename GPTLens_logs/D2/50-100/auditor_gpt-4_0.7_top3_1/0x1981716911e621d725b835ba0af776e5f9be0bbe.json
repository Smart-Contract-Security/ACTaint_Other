[
    {
        "function_name": "changeSeed",
        "code": "function changeSeed(uint32 n) public { if (msg.sender == owner) { seed = uint(n); seed = uint(block.blockhash(block.number-seed))%2000 + 1; } else { revert(); } }",
        "vulnerability": "Predictable RNG",
        "reason": "The randomness used in changeSeed is derived from block.blockhash, which can be manipulated by miners or predicted by observing the blockchain. The use of the seed to modify the block number from which the hash is taken increases predictability, as the seed is publicly settable and influences the results directly.",
        "file_name": "0x1981716911e621d725b835ba0af776e5f9be0bbe.sol"
    },
    {
        "function_name": "buyTickets",
        "code": "function buyTickets() public payable { if (entry == true) { revert(); } entry = true; if (msg.value != (price)) { entry = false; if (keccak256(status) == keccak256(\"Shutdown\")) { selfdestruct(owner); } revert(); } else { if (tickets == 5) { tickets -= 1; ticket1 = msg.sender; } else if(tickets == 4) { tickets -= 1; ticket2 = msg.sender; profit.transfer(price * 1/2); } else if(tickets == 3) { tickets -= 1; ticket3 = msg.sender; } else if(tickets == 2) { tickets -= 1; ticket4 = msg.sender; } else if(tickets == 1) { ticket5 = msg.sender; tickets = 5; round += 1; seed = uint(block.blockhash(block.number-seed))%2000 + 1; uint random_number = uint(block.blockhash(block.number-seed))%5 + 1; lastWiningTicketNumber = random_number; uint pay = (price * 9/2); if (random_number == 1) { ticket1.transfer(pay); lastWinner = ticket1; } else if(random_number == 2) { ticket2.transfer(pay); lastWinner = ticket2; } else if(random_number == 3) { ticket3.transfer(pay); lastWinner = ticket3; } else if(random_number == 4) { ticket4.transfer(pay); lastWinner = ticket4; } else if(random_number == 5) { ticket5.transfer(pay); lastWinner = ticket5; } } } entry = false; }",
        "vulnerability": "Reentrancy",
        "reason": "The function buyTickets allows for reentrancy attacks because it uses the call method (indirectly via transfer) to send ether, which can be hijacked by a malicious contract to re-enter the buyTickets function. The use of an 'entry' flag is intended to prevent reentrancy but it is reset too late in the function, allowing re-entry before the function completes.",
        "file_name": "0x1981716911e621d725b835ba0af776e5f9be0bbe.sol"
    },
    {
        "function_name": "buyTickets",
        "code": "function buyTickets() public payable { if (entry == true) { revert(); } entry = true; if (msg.value != (price)) { entry = false; if (keccak256(status) == keccak256(\"Shutdown\")) { selfdestruct(owner); } revert(); } else { if (tickets == 5) { tickets -= 1; ticket1 = msg.sender; } else if(tickets == 4) { tickets -= 1; ticket2 = msg.sender; profit.transfer(price * 1/2); } else if(tickets == 3) { tickets -= 1; ticket3 = msg.sender; } else if(tickets == 2) { tickets -= 1; ticket4 = msg.sender; } else if(tickets == 1) { ticket5 = msg.sender; tickets = 5; round += 1; seed = uint(block.blockhash(block.number-seed))%2000 + 1; uint random_number = uint(block.blockhash(block.number-seed))%5 + 1; lastWiningTicketNumber = random_number; uint pay = (price * 9/2); if (random_number == 1) { ticket1.transfer(pay); lastWinner = ticket1; } else if(random_number == 2) { ticket2.transfer(pay); lastWinner = ticket2; } else if(random_number == 3) { ticket3.transfer(pay); lastWinner = ticket3; } else if(random_number == 4) { ticket4.transfer(pay); lastWinner = ticket4; } else if(random_number == 5) { ticket5.transfer(pay); lastWinner = ticket5; } } } entry = false; }",
        "vulnerability": "Unrestricted Selfdestruct",
        "reason": "The buyTickets function has a condition that will selfdestruct the contract if the status equals 'Shutdown'. This can be triggered by anyone who sends a transaction with a specific msg.value and can manipulate status changes through the changeStatus function if they gain control over the owner account. This poses a risk of premature contract destruction and loss of funds.",
        "file_name": "0x1981716911e621d725b835ba0af776e5f9be0bbe.sol"
    }
]