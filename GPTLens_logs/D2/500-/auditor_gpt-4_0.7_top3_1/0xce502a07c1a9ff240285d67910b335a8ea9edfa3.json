[
    {
        "function_name": "breakup",
        "code": "function breakup(address _breaker, uint256 _fee) external payable notBreakup oneOfOwners(_breaker) callByBank {\n if(_fee!=0){BankCore(BANKACCOUNT).receiveFee.value(_fee)();}\n if(_breaker==owner1) {owner2.transfer(this.balance);}\n if(_breaker==owner2) {owner1.transfer(this.balance);}\n status=Status.BreakUp;\n}",
        "vulnerability": "Reentrancy",
        "reason": "This function allows for a reentrancy attack because it makes an external call to 'BankCore(BANKACCOUNT).receiveFee.value(_fee)()' and transfers the balance to an owner before updating the status to 'BreakUp'. An attacker could potentially re-enter this function in the context of the external call and drain the contract funds or cause other unintended effects.",
        "file_name": "0xce502a07c1a9ff240285d67910b335a8ea9edfa3.sol"
    },
    {
        "function_name": "withdrawConfirm",
        "code": "function withdrawConfirm(uint256 _amount, address _confirmer) external payable notBreakup oneOfOwners(_confirmer) callByBank {\n require(uint(status)==2);\n require(_amount==request_amount);\n require(_confirmer!=withdrawer);\n require(this.balance>=request_amount);\n if(request_fee!=0){BankCore(BANKACCOUNT).receiveFee.value(request_fee)();}\n withdrawer.transfer(request_amount-request_fee);\n status=Status.Active;\n withdrawer=address(0);\n request_amount=0;\n request_fee=0;\n}",
        "vulnerability": "Reentrancy",
        "reason": "Similar to the breakup function, this function is vulnerable to reentrancy attacks. It calls an external function 'BankCore(BANKACCOUNT).receiveFee.value(request_fee)()' and transfers funds to 'withdrawer' before resetting the request parameters and status. This could allow an attacker to re-enter and influence the contract state or withdraw more funds than intended.",
        "file_name": "0xce502a07c1a9ff240285d67910b335a8ea9edfa3.sol"
    },
    {
        "function_name": "withdraw",
        "code": "function withdraw(uint256 amount, address _to, uint256 _fee) external notBreakup oneOfOwners(_to) callByBank {\n require(this.balance>=amount);\n status =Status.RequestPending;\n request_amount = amount;\n withdrawer = _to;\n request_fee = _fee;\n}",
        "vulnerability": "DoS with unexpected revert",
        "reason": "If the contract balance is lower than the 'amount' specified, the function will revert due to the require statement. This could be used as a denial of service (DoS) attack if an attacker intentionally triggers this condition to prevent legitimate withdrawals by depleting the contract's balance or setting a high withdrawal amount.",
        "file_name": "0xce502a07c1a9ff240285d67910b335a8ea9edfa3.sol"
    }
]