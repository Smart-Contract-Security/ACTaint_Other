[
    {
        "function_name": "kill",
        "code": "function kill() onlyowner { if (msg.sender == owner) suicide(owner); }",
        "vulnerability": "Use of deprecated function",
        "reason": "The function uses 'suicide(owner)', which is deprecated in favor of 'selfdestruct(owner)'. Using deprecated functions can lead to unexpected behavior in smart contracts and reduce the clarity and security of the code.",
        "file_name": "0xfa1bcd27da169c69bfbeda681c2a8277b8e08171.sol"
    },
    {
        "function_name": "registerDocument",
        "code": "function registerDocument(string hash, string link, string data) { address creator = msg.sender; uint id = documentsCount + 1; documentsIds[id] = Document({ hash: hash, link: link, data: data, creator: creator, date: now, signsCount: 0 }); documentsCount = id; DocumentRegistered(id, hash); }",
        "vulnerability": "Unbounded loop potential",
        "reason": "The function increments 'documentsCount' for every new document registered without any upper limit. This can lead to excessive gas consumption if the function is called iteratively in a short period, potentially resulting in denial of service if the loop runs out of gas or the block gas limit is reached.",
        "file_name": "0xfa1bcd27da169c69bfbeda681c2a8277b8e08171.sol"
    },
    {
        "function_name": "addSignature",
        "code": "function addSignature(uint id) { address member = msg.sender; Document d = documentsIds[id]; uint count = d.signsCount; bool signed = false; if (count != 0) { for (uint i = 0; i < count; i++) { if (d.signs[i].member == member) { signed = true; break; } } } if (!signed) { d.signs[count] = Sign({ member: member, date: now }); documentsIds[id].signsCount = count + 1; DocumentSigned(id, member); } }",
        "vulnerability": "Unchecked external call",
        "reason": "The function does not validate whether the document ID provided exists within the mapping, leading to potential out of bounds errors or incorrect data manipulation if an invalid ID is provided. There is no check for the validity of the document ID, which can allow users to attempt to sign non-existent documents and manipulate the state of the contract unpredictably.",
        "file_name": "0xfa1bcd27da169c69bfbeda681c2a8277b8e08171.sol"
    }
]