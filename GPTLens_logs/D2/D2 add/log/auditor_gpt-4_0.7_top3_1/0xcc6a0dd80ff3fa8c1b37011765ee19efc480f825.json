[
    {
        "function_name": "getTokens",
        "code": "function getTokens() payable canDistr onlyWhitelist public {\n    if (value > totalRemaining) {\n        value = totalRemaining;\n    }\n    require(value <= totalRemaining);\n    address investor = msg.sender;\n    uint256 toGive = value;\n    distr(investor, toGive);\n    if (toGive > 0) {\n        blacklist[investor] = true;\n    }\n    if (totalDistributed >= totalSupply) {\n        distributionFinished = true;\n    }\n    value = value.div(100000).mul(99999);\n}",
        "vulnerability": "Reentrancy",
        "reason": "The 'getTokens' function performs a state modification after calling an external contract ('distr' function which in turn triggers 'Transfer' event). This could allow an attacker to re-enter into the contract before the state (e.g., 'blacklist[investor]') is set to true, potentially allowing for manipulation or unintended behavior.",
        "file_name": "0xcc6a0dd80ff3fa8c1b37011765ee19efc480f825.sol"
    },
    {
        "function_name": "burn",
        "code": "function burn(uint256 _value) onlyOwner public {\n    require(_value <= balances[msg.sender]);\n    address burner = msg.sender;\n    balances[burner] = balances[burner].sub(_value);\n    totalSupply = totalSupply.sub(_value);\n    totalDistributed = totalDistributed.sub(_value);\n    Burn(burner, _value);\n}",
        "vulnerability": "Integer Underflow",
        "reason": "The 'burn' function reduces 'totalDistributed' which can lead to underflow if '_value' is greater than 'totalDistributed'. This can cause 'totalDistributed' to become a very large value, potentially disrupting the token distribution logic and leading to unpredictable state changes in the contract.",
        "file_name": "0xcc6a0dd80ff3fa8c1b37011765ee19efc480f825.sol"
    },
    {
        "function_name": "withdrawForeignTokens",
        "code": "function withdrawForeignTokens(address _tokenContract) onlyOwner public returns (bool) {\n    ForeignToken token = ForeignToken(_tokenContract);\n    uint256 amount = token.balanceOf(address(this));\n    return token.transfer(owner, amount);\n}",
        "vulnerability": "Unchecked External Call",
        "reason": "The function 'withdrawForeignTokens' transfers tokens based on the 'ForeignToken' contract without checking the return value of 'token.transfer(owner, amount)'. If the transfer fails for any reason (e.g., due to a failed assertion in the external token contract), the failure will not be detected and handled, potentially leading to inconsistent token accounting or loss of funds.",
        "file_name": "0xcc6a0dd80ff3fa8c1b37011765ee19efc480f825.sol"
    }
]