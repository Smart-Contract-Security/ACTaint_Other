[
    {
        "function_name": "setImplementation",
        "code": "function setImplementation(address newImplementation_) external override { require(msg.sender == _factory(), \"ML:SI:NOT_FACTORY\"); require(_setImplementation(newImplementation_), \"ML:SI:FAILED\"); }",
        "vulnerability": "Centralized control risk",
        "reason": "The function 'setImplementation' allows the factory (centralized entity) to change the contract's implementation. If the factory address is compromised, it could lead to undesirable changes in the contract logic, jeopardizing the integrity and security of the contract.",
        "file_name": "MapleLoan.sol"
    },
    {
        "function_name": "migrate",
        "code": "function migrate(address migrator_, bytes calldata arguments_) external override { require(msg.sender == _factory(), \"ML:M:NOT_FACTORY\"); require(_migrate(migrator_, arguments_), \"ML:M:FAILED\"); }",
        "vulnerability": "Centralized control risk",
        "reason": "Similarly to 'setImplementation', the 'migrate' function also permits the factory to migrate the contract to a new address. This function poses a centralization risk, where if the factory's security is breached, an attacker could redirect the contract's functionalities or state to a malicious contract.",
        "file_name": "MapleLoan.sol"
    },
    {
        "function_name": "skim",
        "code": "function skim(address token_, address destination_) external override whenProtocolNotPaused returns (uint256 skimmed_) { require((msg.sender == _borrower) || (msg.sender == _lender), \"L:S:NO_AUTH\"); require((token_ != _fundsAsset) && (token_ != _collateralAsset), \"L:S:INVALID_TOKEN\"); emit Skimmed(token_, skimmed_ = IERC20(token_).balanceOf(address(this)), destination_); require(ERC20Helper.transfer(token_, destination_, skimmed_), \"L:S:TRANSFER_FAILED\"); }",
        "vulnerability": "Funds redirection",
        "reason": "The 'skim' function allows either the borrower or lender to transfer any ERC20 tokens (not the predefined funds or collateral assets) from the contract to any address. While this aims to remove any mistakenly sent tokens, it could be exploited if sensitive access controls or checks are bypassed, leading to potential loss of valuable tokens stored in the contract.",
        "file_name": "MapleLoan.sol"
    }
]