[
    {
        "function_name": "swapCollateralIndexes",
        "code": "function swapCollateralIndexes(uint256 _index1, uint256 _index2) public onlyControl {\n    CollateralInfo memory tmp = collateral[_index1];\n    collateral[_index1] = collateral[_index2];\n    collateral[_index2] = tmp;\n}",
        "vulnerability": "Array index out of bounds",
        "reason": "This function swaps two collateral entries at specified indexes without validating whether the provided indexes are within the bounds of the collateral array. This can lead to an out-of-bounds exception and may cause the contract to revert, potentially disrupting service and leading to denial of service (DoS) if exploited.",
        "file_name": "USSD.sol"
    },
    {
        "function_name": "mintForToken",
        "code": "function mintForToken(address token, uint256 tokenAmount, address to) public returns (uint256 stableCoinAmount) {\n    require(hasCollateralMint(token), \"unsupported token\");\n    IERC20Upgradeable(token).safeTransferFrom(msg.sender, address(this), tokenAmount);\n    stableCoinAmount = calculateMint(token, tokenAmount);\n    _mint(to, stableCoinAmount);\n    emit Mint(msg.sender, to, token, tokenAmount, stableCoinAmount);\n}",
        "vulnerability": "Unchecked return value",
        "reason": "This function does not check the return value of `calculateMint`, which calculates how much stablecoin to mint based on the token's amount and price. If `calculateMint` encounters an error such as an invalid token address or a failure to fetch the token price, it might return an incorrect amount of stable coins. This can lead to incorrect minting of the stablecoin, potentially disrupting the token's peg and the overall economic mechanisms of the contract.",
        "file_name": "USSD.sol"
    },
    {
        "function_name": "approveToRouter",
        "code": "function approveToRouter(address _token) public {\n    IERC20Upgradeable(_token).approve(address(uniRouter), 0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff);\n}",
        "vulnerability": "Unlimited approval",
        "reason": "This function allows for unlimited approval of tokens to the Uniswap router. If the Uniswap router or the admin account ever gets compromised, an attacker could potentially drain all the funds of the approved token from any user who has called this function. This poses a significant risk to the security of funds held by users and the overall integrity of the contract.",
        "file_name": "USSD.sol"
    }
]